<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[never615]]></title>
  <subtitle><![CDATA[创造价值]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://never615.com/"/>
  <updated>2016-03-17T15:11:00.000Z</updated>
  <id>http://never615.com/</id>
  
  <author>
    <name><![CDATA[never615]]></name>
    <email><![CDATA[never615@gmail.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[linux下使用gcc编译so库]]></title>
    <link href="http://never615.com/2016/03/17/linux%E4%B8%8B%E4%BD%BF%E7%94%A8gcc%E7%BC%96%E8%AF%91so%E5%BA%93/"/>
    <id>http://never615.com/2016/03/17/linux下使用gcc编译so库/</id>
    <published>2016-03-17T15:11:00.000Z</published>
    <updated>2016-03-17T15:11:00.000Z</updated>
    <content type="html"><![CDATA[<p>最近公司在做微信端的定位和导航，所以需要云端提供导航和定位功能，为了复用之前客户端的代码，所以我需要把c文件编译成linux下可以运行的so库，记录一下过程。</p>
<a id="more"></a>
<p>由于没有搞过，所以遇到问题也不知道具体是哪里的问题，所以就一路乱试。。。最后试了下，可以用。</p>
<h3 id="用到的一些gcc命令"><a href="#用到的一些gcc命令" class="headerlink" title="用到的一些gcc命令"></a>用到的一些gcc命令</h3><blockquote>
<p>-shared:指定生成动态连接库,不用该标志外部程序无法连接。相当于一个可执行文件(我开始没加这个，报错找不到main)</p>
<p>-fPIC:表示编译为位置独立的代码，不用此选项的话编译后的代码是位置相关的所以动态载入时是通过代码拷贝的方式来满足不同进程的需要，而不能达到真正代码段共享的目的。</p>
<p>-I:指定头文件所在的文件夹</p>
</blockquote>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><h4 id="编译时报错：找不到jni-h"><a href="#编译时报错：找不到jni-h" class="headerlink" title="编译时报错：找不到jni.h"></a>编译时报错：找不到jni.h</h4><p>我用虚拟机装了Ubuntu，输入java没有找到，然后按着提示随便装了一个。。。<br>当然我现在知道装的是OpenJDK(<a href="https://www.zhihu.com/question/19646618" target="_blank" rel="external">OpenJDK和SunJDK的区别</a>)，google也决定在android N中使用OpenJDK了(<a href="http://www.infoq.com/cn/news/2016/01/android-openjdk" target="_blank" rel="external">相关报道</a>)。。</p>
<p>所以我又下载了SunJDK，编译的时候要引用相关文件,加如下命令</p>
<pre><code>-I/[jdk目录]/include -I/[jdk目录]/include/linux
</code></pre><p>[jdk目录]/include是jni.h所在目录；<br>[jdk目录]/include/linux是jni_md.h所在目录</p>
<h4 id="编译报错：找不到main"><a href="#编译报错：找不到main" class="headerlink" title="编译报错：找不到main"></a>编译报错：找不到main</h4><p>没有加命令 -shared(命令介绍参考上面)</p>
<h4 id="编译时报错：找不到math-h"><a href="#编译时报错：找不到math-h" class="headerlink" title="编译时报错：找不到math.h"></a>编译时报错：找不到math.h</h4><p>使用math.h中声明的库函数，gcc命令行必须加-lm选项，因为数学函数位于libm.so库文件中（这些库文件通常位于/lib目录下），-lm选项告诉编译器，我们程序中用到的数学函数要到这个库文件里找。</p>
<p>我最后是把c文件一个一个编译成.o然后，然后在编译成.so的，因为怕出错，不知道哪个文件的问题。。。当然也可以直接一句话如下：</p>
<pre><code>gcc [.c文件，多个用空格隔开] -fPIC -shared -I/usr/xxx/include -I/usr/xxx/include/linux -lm -o libtest.so
</code></pre><p>编译成.o命令:gcc -c test.c</p>
<p>.o编译成.so:gcc test.o -o test(默认会添加lib前缀和.so后缀)</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>最近公司在做微信端的定位和导航，所以需要云端提供导航和定位功能，为了复用之前客户端的代码，所以我需要把c文件编译成linux下可以运行的so库，记录一下过程。</p>]]>
    
    </summary>
    
      <category term="gcc" scheme="http://never615.com/tags/gcc/"/>
    
      <category term="so库" scheme="http://never615.com/tags/so%E5%BA%93/"/>
    
      <category term="linux" scheme="http://never615.com/categories/linux/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[个人小站建站记]]></title>
    <link href="http://never615.com/2016/02/26/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%AB%99%E5%BB%BA%E7%AB%99%E8%AE%B0/"/>
    <id>http://never615.com/2016/02/26/个人小站建站记/</id>
    <published>2016-02-25T17:38:25.000Z</published>
    <updated>2016-02-25T17:38:24.000Z</updated>
    <content type="html"><![CDATA[<h1 id="个人小站建站记"><a href="#个人小站建站记" class="headerlink" title="个人小站建站记"></a>个人小站建站记</h1><blockquote>
<p>折腾了两天终于搭起了自己的第一个站点，恩，一件让我充满幸福感的事☺️。</p>
</blockquote>
<p>小站是用git page和hexo搭建的，使用的的主题是<a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">NexT</a>。我选择主题最重要的标准就是文章的目录好不好用，哈哈，所以看了很多之后选择了这个。</p>
<a id="more"></a>
<p>未来计划业余技术时间主要在以下两个个方面，这些也将伴随着小站内容的丰富。</p>
<p><strong>web</strong></p>
<p>最近也计划复习复习web并加深学习一下，一来是为了自己玩的更爽，二来是因为随着学习的深入，越来越发觉编程思想的相通，而相比android，web发展则要久远的多，过去一段时间在android圈一个一个火起来的东西，思想在web圈由来已有，三来也是为之后跨平台的学习做一个铺垫。</p>
<p><strong>android</strong></p>
<p>此外也计划把之前学习的android知识在系统的整理一下，同时也买了两本android的书和一本讲android源码设计模式的，当做工具书和查漏补缺，完善我的知识体系，我是比较喜欢记笔记的，人生苦短，我可不想全部都装脑子里。。。如果用的比较少忘记了，很快查一下笔记就好了。</p>
<img src="/2016/02/26/个人小站建站记/ScreenShot.png" alt="ScreenShot.png" title="">
<p><em>主要精力应该还是在android这边，android这边感觉现在有点瓶颈，主要应该是积累的还不够，导致最近在插件化方面的研究有些吃力</em></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="个人小站建站记"><a href="#个人小站建站记" class="headerlink" title="个人小站建站记"></a>个人小站建站记</h1><blockquote>
<p>折腾了两天终于搭起了自己的第一个站点，恩，一件让我充满幸福感的事☺️。</p>
</blockquote>
<p>小站是用git page和hexo搭建的，使用的的主题是<a href="https://github.com/iissnan/hexo-theme-next">NexT</a>。我选择主题最重要的标准就是文章的目录好不好用，哈哈，所以看了很多之后选择了这个。</p>]]>
    
    </summary>
    
      <category term="随笔" scheme="http://never615.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="随笔" scheme="http://never615.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
</feed>
